<meta charset="UTF-8">
<button id="donky">load donkey kong</button>
<button id="break">load breakout</button>
<button id="close">close popups</button>
<script>
    var popups = [],
        popupGap = undefined;

    function closeWindows() {
        var popup;

        running = false;

        while (popups.length) {
            popup = popups.shift();
            popup.close();
        }
    }

    function setupPopups(url, count) {
        var i, settings, popup, y,
            popupWidth = window.outerWidth,
            popupHeight = 50,
            x = window.screenX,
            yOffset = window.screenY + (window.outerHeight - window.innerHeight);

        closeWindows();

        for (i = 0; i < count; i ++) {
            y = i * (popupGap||50) + yOffset;

            settings = 'width='+popupWidth+',height='+popupHeight+',left='+x+',top='+y;

            popup = window.open(url+'#'+i, 'w'+i, settings);

            if (popupGap == undefined) {
                setTimeout(function () {
                    popupGap = popup.outerHeight - popup.innerHeight;
                    setupPopups.call(null, url, count);
                }, 500);
                return;
            }
            else {
                popups.push(popup);
            }
        }

        setTimeout(function () {
            popups.forEach(function (popup) {
                popup.document.title = '-';
            });
            popups[popups.length-1].popups = popups;
            popups[popups.length-1].setup();
        }, 1000);
    }

    window.addEventListener('load', function () {
        document.getElementById('donky').addEventListener('click', function () {setupPopups('dk.html', 7);});
        document.getElementById('break').addEventListener('click', function () {setupPopups('break.html', 7);});
        document.getElementById('close').addEventListener('click', closeWindows);
    });
</script>
