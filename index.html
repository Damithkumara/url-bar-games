<meta charset="UTF-8">
<button id="click">click to load</button>
<script>
    var popups,
        levelHeight = 7,
        popupGap = undefined;

    function setupPopups() {
        var i, settings, popup, y,
            popupWidth = window.outerWidth,
            popupHeight = 50,
            x = window.screenX,
            yOffset = window.screenY + (window.outerHeight - window.innerHeight);

        popups = [];

        for (i = 0; i < levelHeight; i ++) {
            y = i * (popupGap||50) + yOffset;

            settings = 'width='+popupWidth+',height='+popupHeight+',left='+x+',top='+y;

            popup = window.open('dk.html#'+i, 'w'+i, settings);

            if (popupGap == undefined) {
                setTimeout(function () {
                    popupGap = popup.outerHeight - popup.innerHeight;
                    //popup.close();
                    setupPopups();
                }, 500);
                return;
            }
            else {
                //popup.resizeTo(popupWidth, popupHeight);
                //popup.moveTo(x, y);

                popups.push(popup);
            }
        }

        setTimeout(function () {
            popups.forEach(function (popup) {
                popup.document.title = '-';
            });
            popups[popups.length-1].popups = popups;
            popups[popups.length-1].setup();
        }, 1000);
    }

    window.addEventListener('load', function () {
        setupPopups();
        document.getElementById('click').addEventListener(
            'click',
            setupPopups
        );
    });
</script>
